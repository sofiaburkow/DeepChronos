/home/sofia/Desktop/Thesis/DeepChronos/.venv/lib/python3.10/site-packages/deepproblog/semiring/graph_semiring.py:77: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:836.)
  return -self.eps <= float(a) <= self.eps

Preparing datasets (original)...

Preparing multi_step train' dataset...
Original label distribution (train): Counter({np.int64(0): 55178, np.int64(5): 20252, np.int64(3): 21, np.int64(2): 13, np.int64(4): 13, np.int64(1): 12})
Loading cached train dataset from /home/sofia/Desktop/Thesis/DeepChronos/src/DARPA/data/cache/train_multi_step_original.pkl
Label distribution: Counter({'no_alarm': 55237, 'alarm': 20252})

Preparing multi_step test' dataset...
Original label distribution (test): Counter({np.int64(0): 36785, np.int64(5): 13502, np.int64(3): 14, np.int64(2): 9, np.int64(4): 9, np.int64(1): 8})
Loading cached test dataset from /home/sofia/Desktop/Thesis/DeepChronos/src/DARPA/data/cache/test_multi_step_original.pkl
Label distribution: Counter({'no_alarm': 36825, 'alarm': 13502})

Using pretrained models: True
Loading pretrained model for phase 1...
Loading pretrained model for phase 2...
Loading pretrained model for phase 3...
Loading pretrained model for phase 4...
Loading pretrained model for phase 5...

Caching ACs
Training  for 1 epoch(s)
Epoch 1
Iteration:  100 	s:8.5802 	Average Loss:  0.46973548244271657
Iteration:  200 	s:8.5116 	Average Loss:  0.4471916290824257
Iteration:  300 	s:8.4816 	Average Loss:  0.45129898638567023
Iteration:  400 	s:8.4180 	Average Loss:  0.4355816760080803
Iteration:  500 	s:8.5391 	Average Loss:  0.4255229375220175
Iteration:  600 	s:11.7702 	Average Loss:  0.40941167453849464
Iteration:  700 	s:17.2476 	Average Loss:  0.4102445560948182
Iteration:  800 	s:17.2927 	Average Loss:  0.4100059185348177
Iteration:  900 	s:17.3275 	Average Loss:  0.4061037619162439
Iteration:  1000 	s:17.2831 	Average Loss:  0.4000657862244347
Iteration:  1100 	s:17.2320 	Average Loss:  0.40049222110761123
Iteration:  1200 	s:17.3123 	Average Loss:  0.40201508811149883
Iteration:  1300 	s:17.2687 	Average Loss:  0.39876531275475363
Iteration:  1400 	s:17.2649 	Average Loss:  0.40034570393387015
Iteration:  1500 	s:17.1029 	Average Loss:  0.401568299240801
Epoch time:  211.52544593811035
Accuracy:  0.7316947165537385

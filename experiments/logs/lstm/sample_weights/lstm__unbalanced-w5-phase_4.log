COMMAND: uv run python experiments/models/lstm.py experiments/preprocessing/processed_data/temporal/unbalanced/w5/phase_4/ True
START: 20251220T104106Z

2025-12-20 11:41:07.271704: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-20 11:41:07.338427: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-12-20 11:41:08.849413: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-20 11:41:10.111294: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: UNKNOWN ERROR (303)
/home/sofia/Desktop/Thesis/DeepChronos/.venv/lib/python3.10/site-packages/keras/src/layers/rnn/rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Epoch 1/50
1062/1062 - 6s - 6ms/step - accuracy: 0.9900 - loss: 0.8745 - val_accuracy: 0.9938 - val_loss: 0.7271
Epoch 2/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9481 - loss: 0.3064 - val_accuracy: 0.9954 - val_loss: 0.4400
Epoch 3/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9678 - loss: 0.1220 - val_accuracy: 0.9907 - val_loss: 0.0553
Epoch 4/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9807 - loss: 0.0800 - val_accuracy: 0.9819 - val_loss: 0.0384
Epoch 5/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9814 - loss: 0.0433 - val_accuracy: 0.9877 - val_loss: 0.0256
Epoch 6/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9946 - loss: 0.0124 - val_accuracy: 0.9988 - val_loss: 0.0180
Epoch 7/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9979 - loss: 0.0063 - val_accuracy: 0.9992 - val_loss: 0.2662
Epoch 8/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9962 - loss: 0.0092 - val_accuracy: 0.9989 - val_loss: 0.0639
Epoch 9/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9983 - loss: 0.0053 - val_accuracy: 0.9989 - val_loss: 0.0097
Epoch 10/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9979 - loss: 0.0094 - val_accuracy: 0.9989 - val_loss: 0.0275
Epoch 11/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9987 - loss: 0.0040 - val_accuracy: 0.9992 - val_loss: 0.0306
Epoch 12/50
1062/1062 - 5s - 5ms/step - accuracy: 0.9990 - loss: 0.0030 - val_accuracy: 0.9992 - val_loss: 0.0493
Epoch 13/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9989 - loss: 0.0036 - val_accuracy: 0.9991 - val_loss: 0.0077
Epoch 14/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9982 - loss: 0.1850 - val_accuracy: 0.9989 - val_loss: 0.0324
Epoch 15/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9987 - loss: 0.0033 - val_accuracy: 0.9992 - val_loss: 0.0886
Epoch 16/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9990 - loss: 0.0025 - val_accuracy: 0.9993 - val_loss: 0.0939
Epoch 17/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9991 - loss: 0.0037 - val_accuracy: 0.9993 - val_loss: 0.0549
Epoch 18/50
1062/1062 - 4s - 4ms/step - accuracy: 0.9990 - loss: 0.0035 - val_accuracy: 0.9992 - val_loss: 0.0535
[1m   1/1573[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m3:42[0m 142ms/step[1m  34/1573[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 2ms/step    [1m  70/1573[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 1ms/step[1m 107/1573[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 1ms/step[1m 140/1573[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 1ms/step[1m 173/1573[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 1ms/step[1m 208/1573[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 245/1573[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 280/1573[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 316/1573[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 353/1573[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 389/1573[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 426/1573[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 463/1573[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 498/1573[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 532/1573[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 568/1573[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 602/1573[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 634/1573[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 662/1573[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 694/1573[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 730/1573[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 767/1573[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 801/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 837/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 874/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m1s[0m 1ms/step[1m 910/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m 944/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m 978/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1013/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1050/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1085/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1121/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1158/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1193/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1229/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 1ms/step[1m1265/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 1ms/step[1m1296/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 1ms/step[1m1331/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 1ms/step[1m1366/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 1ms/step[1m1402/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 1ms/step[1m1436/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 1ms/step[1m1471/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 1ms/step[1m1507/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 1ms/step[1m1544/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 1ms/step[1m1573/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 2ms/step[1m1573/1573[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m3s[0m 2ms/step
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Number of misclassified samples: 63
Misclassified samples per phase:
Phase 0: 55 samples
Phase 1: 0 samples
Phase 2: 1 samples
Phase 3: 4 samples
Phase 4: 2 samples
Phase 5: 1 samples

Misclassified samples plot saved to: experiments/results/lstm/sample_weights/w5/phase_4/misclassified_samples.png
=== LSTM Results ===
Accuracy:  0.9987
Precision: 0.0615
Recall:    0.6667
F1-Score:  0.1127
Confusion Matrix:
[[50266    61]
 [    2     4]]

END: 20251220T104232Z
RETURN_CODE: 0
